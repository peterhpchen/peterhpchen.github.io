---
layout: post
title: 在SQL Server 2012安裝Northwind資料庫
date: '2016-04-03T01:30:00.000-07:00'
author: Peter
tags:
- SQL server
modified_time: '2016-04-03T01:30:36.186-07:00'
thumbnail: https://2.bp.blogspot.com/-2vLAGiCijaA/VwDHdm6l0MI/AAAAAAAAAbs/-k5mS8s_4J04HHLGMyKNlmP2ehy8UYl9Q/s72-c/%25E5%25AE%2589%25E8%25A3%259DNorthwind01.PNG
blogger_id: tag:blogger.com,1999:blog-8081092262828660128.post-7383213751172289455
blogger_orig_url: https://limitlessping.blogspot.com/2016/04/sql-server-2012northwind.html
permalink: /:year/:month/:title:output_ext
---

Northwind是微軟提供的範例資料庫，我們可以利用這個資料庫來練習資料庫或程式語言相關的技術，但這個資料庫是SQL Server 2000的範例，安裝在SQL Server 2012可能會碰到一些問題，這篇文章是我自己在安裝時所碰到的問題紀錄。<br /><h2>下載</h2><div>可以在微軟網站中下載：</div><div><a href="https://www.microsoft.com/en-us/download/details.aspx?id=23654">https://www.microsoft.com/en-us/download/details.aspx?id=23654</a></div><h2>安裝</h2><div>照下面圖示操作即可：</div><div><a href="http://2.bp.blogspot.com/-2vLAGiCijaA/VwDHdm6l0MI/AAAAAAAAAbs/-k5mS8s_4J04HHLGMyKNlmP2ehy8UYl9Q/s1600/%25E5%25AE%2589%25E8%25A3%259DNorthwind01.PNG" imageanchor="1"><img border="0" height="227" src="https://2.bp.blogspot.com/-2vLAGiCijaA/VwDHdm6l0MI/AAAAAAAAAbs/-k5mS8s_4J04HHLGMyKNlmP2ehy8UYl9Q/s320/%25E5%25AE%2589%25E8%25A3%259DNorthwind01.PNG" width="320" /></a><br /><a href="http://1.bp.blogspot.com/-juVjE8Mkz04/VwDHgI5SriI/AAAAAAAAAb0/H_Kil-mqZ3wtsNocTI9ksrzPQcgdKdWAQ/s1600/%25E5%25AE%2589%25E8%25A3%259DNorthwind02.PNG" imageanchor="1"><img border="0" height="224" src="https://1.bp.blogspot.com/-juVjE8Mkz04/VwDHgI5SriI/AAAAAAAAAb0/H_Kil-mqZ3wtsNocTI9ksrzPQcgdKdWAQ/s320/%25E5%25AE%2589%25E8%25A3%259DNorthwind02.PNG" width="320" /></a><br /><a href="http://1.bp.blogspot.com/-PJCcQW001nA/VwDHiEuieZI/AAAAAAAAAb8/I-f_FrJRBRMhLrJLkLHPTQiCf_ZWGxEjg/s1600/%25E5%25AE%2589%25E8%25A3%259DNorthwind03.PNG" imageanchor="1"><img border="0" height="225" src="https://1.bp.blogspot.com/-PJCcQW001nA/VwDHiEuieZI/AAAAAAAAAb8/I-f_FrJRBRMhLrJLkLHPTQiCf_ZWGxEjg/s320/%25E5%25AE%2589%25E8%25A3%259DNorthwind03.PNG" width="320" /></a><br /><a href="http://1.bp.blogspot.com/-fuuIBMTEavE/VwDHkqQ8TQI/AAAAAAAAAcE/PFULb5Fc5uUIcaY_EbcTiS_IZ8qZNbfiw/s1600/%25E5%25AE%2589%25E8%25A3%259DNorthwind04.PNG" imageanchor="1"><img border="0" height="225" src="https://1.bp.blogspot.com/-fuuIBMTEavE/VwDHkqQ8TQI/AAAAAAAAAcE/PFULb5Fc5uUIcaY_EbcTiS_IZ8qZNbfiw/s320/%25E5%25AE%2589%25E8%25A3%259DNorthwind04.PNG" width="320" /></a><br />上述步驟完成後在C:\SQL Server 2000 Sample Databases中找到需要的檔案。<br /><h2>問題及解決</h2></div><div>現在有兩個方法可以安裝Northwind，一個是Attach Database，另一個是直接執行.sql，我先嘗試了Attach的方式。</div><h3>Attach Database</h3><div>在SSMS中對Database按右鍵&gt;Attach</div><div><a href="http://3.bp.blogspot.com/-aWd3hXD1bMM/VwDJyOUEwGI/AAAAAAAAAcU/Vm4z6JFPBKEO2w4nV-6O5TlIHV3Sxqy-A/s1600/Attach%2BDatabase01.png" imageanchor="1"><img border="0" height="216" src="https://3.bp.blogspot.com/-aWd3hXD1bMM/VwDJyOUEwGI/AAAAAAAAAcU/Vm4z6JFPBKEO2w4nV-6O5TlIHV3Sxqy-A/s320/Attach%2BDatabase01.png" width="320" /></a></div><div>Add&gt;NORTHWIND.MDF&gt;OK</div><div><a href="http://1.bp.blogspot.com/-P1Smde9jYRw/VwDLkqwgaxI/AAAAAAAAAcg/zQC7Jgop7bEEynB0vx7Rf6Sta5E36ZlqA/s1600/%25E8%259E%25A2%25E5%25B9%2595%25E6%2588%25AA%25E5%259C%2596%2B2016-04-03%2B15.45.46.png" imageanchor="1"><img border="0" height="196" src="https://1.bp.blogspot.com/-P1Smde9jYRw/VwDLkqwgaxI/AAAAAAAAAcg/zQC7Jgop7bEEynB0vx7Rf6Sta5E36ZlqA/s320/%25E8%259E%25A2%25E5%25B9%2595%25E6%2588%25AA%25E5%259C%2596%2B2016-04-03%2B15.45.46.png" width="320" /></a></div><h4>問題1</h4><div>出現錯誤，點Databases to attach的Message連結，出現錯誤訊息：</div><div><span style="color: #990000;">Operating System error 5</span></div><div><a href="http://1.bp.blogspot.com/-qxA_stCKIvU/VwDMeUVthtI/AAAAAAAAAcs/kR3lPhJgS80hPeiQMsHK1LELYC8m2Gd5A/s1600/Attach%2BDatabase03.png" imageanchor="1"><img border="0" height="105" src="https://1.bp.blogspot.com/-qxA_stCKIvU/VwDMeUVthtI/AAAAAAAAAcs/kR3lPhJgS80hPeiQMsHK1LELYC8m2Gd5A/s320/Attach%2BDatabase03.png" width="320" /></a></div><h4>解決</h4><div>SSMS要以<span style="color: #38761d;">系統管理員身分執行</span></div><div><a href="http://4.bp.blogspot.com/-7OZWymlTUiM/VwDNZVZgtfI/AAAAAAAAAc4/-Fa1pPkYe-Q_x-2l_6kSKBJCdX6oK_JsQ/s1600/Attach%2BDatabase04.png" imageanchor="1"><img border="0" height="222" src="https://4.bp.blogspot.com/-7OZWymlTUiM/VwDNZVZgtfI/AAAAAAAAAc4/-Fa1pPkYe-Q_x-2l_6kSKBJCdX6oK_JsQ/s320/Attach%2BDatabase04.png" width="320" /></a></div><h4>問題2</h4><div><span style="color: #990000;">its non-release version(539)is not supported by this version of SQL Server</span></div><div><a href="http://3.bp.blogspot.com/-yuhyLkXT08c/VwDOcsouKAI/AAAAAAAAAdE/4JOCfWnlnI8SHV7TiY-81t16L4OkHamAQ/s1600/Attach%2BDatabase05.png" imageanchor="1"><img border="0" height="120" src="https://3.bp.blogspot.com/-yuhyLkXT08c/VwDOcsouKAI/AAAAAAAAAdE/4JOCfWnlnI8SHV7TiY-81t16L4OkHamAQ/s320/Attach%2BDatabase05.png" width="320" /></a></div><h4>為何發生</h4><div>Google發現有人也有同樣的問題：</div><div><a href="https://social.msdn.microsoft.com/Forums/sqlserver/en-US/4fac7511-2c75-46a0-802b-807dd26b12bf/sql-2012-will-not-convert-a-sql-2000-database?forum=sqlservermigration">https://social.msdn.microsoft.com/Forums/sqlserver/en-US/4fac7511-2c75-46a0-802b-807dd26b12bf/sql-2012-will-not-convert-a-sql-2000-database?forum=sqlservermigration</a></div><div>SQL Server可以還原資料庫的版本只有前面的兩到三個版本，例如我現在用的是2012，那我可以還原的最舊版本就是2005的，所以當然2012沒辦法還原2000的資料庫。</div><div><br /></div><div>那我們就來看一下執行.sql的方法可不可行好了。</div><h3>Execute SQL</h3><h4>問題</h4><div>把instnwnd.sql直接用SSMS執行，會發生下面的錯誤：</div><div><span style="color: #990000;">Could not &nbsp;find store procedure 'sp_dboption'</span></div><div><a href="http://2.bp.blogspot.com/-9g7w-GOMqKQ/VwDRWIQDVrI/AAAAAAAAAdQ/q2tdFraLioAMKXAQIA-9l28GsQuXx6K8Q/s1600/ExecuteSQL01.png" imageanchor="1"><img border="0" height="115" src="https://2.bp.blogspot.com/-9g7w-GOMqKQ/VwDRWIQDVrI/AAAAAAAAAdQ/q2tdFraLioAMKXAQIA-9l28GsQuXx6K8Q/s320/ExecuteSQL01.png" width="320" /></a></div><div>再次請教Google大神：</div><div><a href="https://technet.microsoft.com/zh-tw/library/ms187310(v=sql.105).aspx">https://technet.microsoft.com/zh-tw/library/ms187310(v=sql.105).aspx</a></div><div>發現到原來sp_dboption已經被棄用了，要改用ALTER DATABASE。</div><div><a href="http://2.bp.blogspot.com/-kO3MMV9rxqQ/VwDSZbvOt3I/AAAAAAAAAdc/J2YPxFeSiN8ujtBRKiZ71pefpNq_bDSnA/s1600/ExecuteSQL02.png" imageanchor="1"><img border="0" height="32" src="https://2.bp.blogspot.com/-kO3MMV9rxqQ/VwDSZbvOt3I/AAAAAAAAAdc/J2YPxFeSiN8ujtBRKiZ71pefpNq_bDSnA/s320/ExecuteSQL02.png" width="320" /></a></div><div>所以代表我們要把sp_dboption的指令轉乘ALTER DATABASE。</div><div>於是我們去查[trunc. log on chkpt.]及[select into/bulkcopy]，很幸運的我們在同一個頁面找到：</div><div><a href="http://4.bp.blogspot.com/-PUPP9KQybF4/VwDTrXagdjI/AAAAAAAAAdo/QwwXX2M8nK4gregGdQnkhdNEI1i8clGlg/s1600/ExecuteSQL03.png" imageanchor="1"><img border="0" height="111" src="https://4.bp.blogspot.com/-PUPP9KQybF4/VwDTrXagdjI/AAAAAAAAAdo/QwwXX2M8nK4gregGdQnkhdNEI1i8clGlg/s320/ExecuteSQL03.png" width="320" /></a></div><div>發現原來這兩行的是在設定復原模式的而且也知道他們要設定的數值，那我們就把這兩行替換成：</div><div><div>ALTER DATABASE Northwind SET RECOVERY SIMPLE</div><div>ALTER DATABASE Northwind SET RECOVERY BULK_LOGGED</div></div><div>之後再執行一次SQL就好了。</div>