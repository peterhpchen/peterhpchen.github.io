---
layout: post
title: 自動登入apple developer
date: '2014-06-26T23:40:00.002-07:00'
author: Peter
tags:
- HttpWebRequest
- C#
modified_time: '2014-07-02T08:14:46.427-07:00'
thumbnail: http://4.bp.blogspot.com/-SguDn2RCO2I/U60LliULowI/AAAAAAAAATo/tfwxMT_gyjw/s72-c/elements.bmp
blogger_id: tag:blogger.com,1999:blog-8081092262828660128.post-7120752059682025997
blogger_orig_url: https://limitlessping.blogspot.com/2014/06/apple-developer.html
---

在工作的時候遇到了需要讓電腦自動登入apple developer的需求，想到的解決方法就是用HttpWebRequest去做網頁的溝通，進而得到cookies，達到登入的目的。<br /><h2>目的</h2><div>利用HttpWebRequest進入apple developer，取得登入所需的cookies。</div><h2>方法</h2><div>我們要模仿網頁的互動就要先去觀察網頁的傳遞方式，所以第一步我們要做的觀察，我們知道網頁的運作方式之後就可以將開始寫程式了，利用HttpWebRequest來模仿browser中我們所做的動作，達到登入的目的。</div><h2>步驟</h2><h3>1. 觀察網頁運作</h3><div>這裡我們利用chrome的developer tools(在chrome上按下F12即可使用)，我們在觀察方面有2個部分要注意的：</div><h4>1. 傳送帳號密碼的真正網址</h4><div>網頁的設計常常會再登入中間安插一個專門處理的網頁，如果網頁是這樣設計的話那我們表面上看到的那個uri就不是真正在做登入的頁面了，為了避免這樣的情況，我們可以利用developer tools來找到真正做處理的uri。</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-SguDn2RCO2I/U60LliULowI/AAAAAAAAATo/tfwxMT_gyjw/s1600/elements.bmp" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-SguDn2RCO2I/U60LliULowI/AAAAAAAAATo/tfwxMT_gyjw/s1600/elements.bmp" height="188" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">在這裡我們可以看到Post的網頁其實是action中的uri，而非原本的uri</td></tr></tbody></table><h4>2. headers</h4><div>接下來我們就要去看看網頁的標頭檔是什麼樣子的，由developer tools我們可以看到網頁的標頭檔。</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-Hxy-vbiOZw0/U60NktX8DJI/AAAAAAAAAT0/o9O7gN5se_U/s1600/network.bmp" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-Hxy-vbiOZw0/U60NktX8DJI/AAAAAAAAAT0/o9O7gN5se_U/s1600/network.bmp" height="205" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">紅色框框部分為要注意的部分</td></tr></tbody></table><h3>2. 撰寫程式碼</h3><div>先處理第一點的第一個部分，我們要先抓出真正的uri，在這裡我們使用的是<a href="http://htmlagilitypack.codeplex.com/">Html Agility Pack</a>，這個package可以利用元素的XPath找出那個元素的屬性，要找出元素的XPath也很容易，只要使用developer tools就可以了。</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-gKlzDpW398s/U60PK8xh6CI/AAAAAAAAAUA/pBZrsHwaq1k/s1600/xpath.bmp" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-gKlzDpW398s/U60PK8xh6CI/AAAAAAAAAUA/pBZrsHwaq1k/s1600/xpath.bmp" height="147" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">元素&gt;按右鍵&gt;Copy XPath</td></tr></tbody></table>找出XPath後我們才算是真正開始寫程式碼，我們可以把程式分成兩個部分：<br /><div><ol><li>找出真正處理的uri</li><li>撰寫正確的request取回登入資訊的cookies</li></ol><div>再來是程式碼的部分</div></div><div><br /></div><script src="https://gist.github.com/CodingCodeChen/0fcc1fdb620d9fdb2cf1.js"></script> <br /><h2>結論</h2><div>其實要自動登入很簡單，只要熟悉http的運作就可以很容易的做出，在這個部份我覺得最重要的就是google developer tools要熟練。</div>